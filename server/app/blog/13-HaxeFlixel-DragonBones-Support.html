<!DOCTYPE html><html lang="en" class="__className_9318ce"><head><link rel="preload" href="/_next/static/media/f884d4ea94220255.p.woff2" as="font" type="font/woff2" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/97bdc754440853c7.css" data-precedence="high"/><link rel="stylesheet" href="/_next/static/css/b76f6b40b08cf2ac.css" data-precedence="high"/><link rel="stylesheet" href="/_next/static/css/464b40a213f0faa2.css" data-precedence="high"/><link rel="stylesheet" href="/_next/static/css/b8f6d7805f6cf732.css" data-precedence="high"/><link rel="stylesheet" href="/_next/static/css/3966fc2c7f21f103.css" data-precedence="high"/><script async="" src="https://platform.twitter.com/widgets.js" charSet="utf-8"></script><title>HaxeFlixel.com</title><meta name="description" content="HaxeFlixel is a 2D Game Engine that lets you create cross-platform games easier with free, open source technology!"/><meta name="keywords" content="gamedev, game development, cross-platform, haxe, flixel"/><link rel="icon" href="/images/favicon.ico"/><script defer="" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script><script defer="" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" nomodule=""></script></head><body><div class="navbar navbar-inverse navbar-fixed-top"><div class="container"><div class="navbar-header"><button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/"><img alt="HaxeFlixel" srcSet="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fhaxeflixel-header.19d77213.png&amp;w=128&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fhaxeflixel-header.19d77213.png&amp;w=256&amp;q=75 2x" src="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fhaxeflixel-header.19d77213.png&amp;w=256&amp;q=75" width="100" height="100" decoding="async" data-nimg="1" loading="lazy" style="color:transparent;width:169px;height:30px"/></a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav"><li class="dropdown "><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples <span class="caret"></span></a><ul class="dropdown-menu inverse-dropdown"><li><a href="/demos">Demos</a></li><li><a href="https://snippets.haxeflixel.com/">Snippets</a></li></ul></li><li><a href="/showcase">Showcase</a></li><li><a href="/blog">Blog</a></li><li><a href="/documentation">Docs</a></li><li><a href="http://api.haxeflixel.com">API</a></li><li><a href="https://github.com/HaxeFlixel/flixel/discussions">Forum</a></li></ul></div></div></div><main><div data-nextjs-scroll-focus-boundary=""><div data-nextjs-scroll-focus-boundary=""><div data-nextjs-scroll-focus-boundary=""><div class="container container-main"><div class="col-md-8"><h1 class="title">HaxeFlixel DragonBones Support</h1><p class="styles_post-date__mNLdb">September 1, 2018</p><p>Hi there, I’m Troy (<a href="https://twitter.com/roustudios">@RouStudios</a>), creator and maintainer of the <a href="https://github.com/openfl/dragonbones">HaxeFlixel backend for DragonBones</a>. I’m here to write a post about DragonBones support for HaxeFlixel and how to use it.</p>
<p>First of all, what is DragonBones? DragonBones is a free *open source alternative to the popular 2D bone animation tool <a href="http://esotericsoftware.com/">Spine</a> (which Flixel already has support for). Its a tool which allows you to animate static 2D images programmatically (similar to Flash tweening) without having to painstakingly animate each individual frame in a spritesheet. Why would one use it over Spine? Well Spine can potentially be <a href="https://esotericsoftware.com/spine-purchase">quite expensive</a> for new indie devs, and DragonBones is free. Not only that, DragonBones is a fully featured, intuitive bone animation editor and has <a href="https://www.youtube.com/watch?v=XPH_ZBzCtfY">Mesh Deformation support</a> just like Spine. Quite a deal for free!</p>
<img src="/images/blog/13_dragonbones/dragonbones_stock.jpg" width="100%"/>
<p>*One caveat is that DragonBones is not truly open source (if you care about that sort of thing), only the runtime is. If you want a truly open source editor which can export to the DragonBones format while also being fully featured, check out the great alternative <a href="https://github.com/ndee85/coa_tools">COA Tools</a> for Blender. Its DragonBones export should also work with the Flixel backend I’ve created.</p>
<p>How exactly do you use DragonBones with Flixel? Well, that’s what I’ll be showing you, so let’s get started.</p>
<h3>Install</h3>
<p>First install the library from haxelib using:</p>
<pre><code>haxelib install dragonbones
</code></pre>
<p>Although it’s better to install directly from GitHub in order to always keep up with the latest updates:</p>
<pre><code>haxelib git dragonbones https://github.com/openfl/dragonbones
</code></pre>
<h3>Create Project</h3>
<p>Then create a new Flixel project template with <a href="http://haxeflixel.com/documentation/flixel-tools/">Flixel Tools</a>, and add DragonBones to your <code>Project.xml</code>. You can also download <a href="https://github.com/openfl/dragonbones/tree/master/samples/HelloDragonBones">the sample project</a> instead to follow along.</p>
<pre><code class="language-xml">&lt;haxelib name=&quot;dragonbones&quot; /&gt;
</code></pre>
<p>Then create a new animation using DragonBones. For the sake of this tutorial, we’re going to use a premade project that comes with DragonBones called DragonBoy that you can select from the starting menu. Once you’re done, go to <code>File &gt; Export</code> and export the animation using <code>Data Version: 5.0</code> and <code>Image Type: Texture Atlas</code>. Then save it to the <code>assets</code> folder in your Flixel project.</p>
<img src="/images/blog/13_dragonbones/dragonbones_export.png" width="100%"/>
<h3>Packages</h3>
<p>First, import the packages we&#x27;ll be using.</p>
<pre><code class="language-haxe">import haxe.Json;
import openfl.Assets;
import flixel.FlxG;
import flixel.FlxState;
import flixel.group.FlxGroup;
import dragonBones.objects.DragonBonesData;
import dragonBones.flixel.FlixelTextureAtlasData;
import dragonBones.flixel.FlixelArmatureDisplay;
import dragonBones.flixel.FlixelArmatureCollider;
import dragonBones.flixel.FlixelFactory;
import dragonBones.flixel.FlixelEvent;
import dragonBones.animation.WorldClock;
</code></pre>
<h3>Create Factory</h3>
<p>Then, inside the <code>create</code> function under your <code>FlxState</code> class you have to create a <code>FlixelFactory</code> which generates flixel objects for DragonBones like so:</p>
<pre><code class="language-haxe">var _factory = new FlixelFactory();
</code></pre>
<h3>Parse Data</h3>
<p>Then you have to use the factory to parse the animation files that you’ve exported in order to read their data.</p>
<pre><code class="language-haxe">var dragonBonesData:DragonBonesData = _factory.parseDragonBonesData(
	Json.parse(Assets.getText(&quot;assets/dragonboy_flixel_ske.json&quot;))
);

_factory.parseTextureAtlasData(
	Json.parse(Assets.getText(&quot;assets/dragonboy_flixel_tex.json&quot;)),
	Assets.getBitmapData(&quot;assets/dragonboy_flixel_tex.png&quot;)
);
</code></pre>
<h3>Build Armature</h3>
<p>Then you have to create a <code>FlxGroup</code> which will contain all the DragonBones Flixel Sprites. You can do so by declaring a variable and then assigning the new <code>FlxGroup</code> to it which you will generate using the factory.</p>
<pre><code class="language-haxe">var armatureGroup = _factory.buildArmatureDisplay(new FlixelArmatureCollider(250, 250, 27, 25, 13, 8), dragonBonesData.armatureNames[0]);
</code></pre>
<p>One thing to note is you also have to pass in a collision box similar to the Flixel Spine plugin. This is because with many different sprites, if you want to check the collisions of the entire “character” then you have to have one large collision box. You also pass in the name of the armature (the animations skeleton). Generally you’ll only have one armature, so just pass in the first index of the <code>armatureNames</code> array from the data you got earlier. Otherwise, check your animation in DragonBones to find the name and pass it in as a string.</p>
<h3>Set Properties</h3>
<p>Then you iterate through all of the sprites in the <code>FlxGroup</code> to set their initial properties (such as scale, placement in the world, ect.) as you please.</p>
<pre><code class="language-haxe">armatureGroup.forEach(function(display:FlixelArmatureDisplay) {
	display.antialiasing = true;
	display.x = 100;
	display.y = 100;
	display.scaleX = 0.50;
	display.scaleY = 0.50;
});
</code></pre>
<h3>Start Animation</h3>
<p>Now you do the same thing to start the initial animation. Again we grab the first index from the list of animation names to keep it simple.</p>
<pre><code class="language-haxe">armatureGroup.forEach(function(display:FlixelArmatureDisplay) {
	display.animation.play(display.animation.animationNames[0]);
});
</code></pre>
<h3>Update Animation</h3>
<p>Then, inside the update loop of the <code>FlxState</code> class, add <code>FlixelFactory._clock.advanceTime(-1);</code> to update the animation clock so that the factory knows what point it&#x27;s at on the timeline.</p>
<pre><code class="language-haxe">override public function update(elapsed:Float):Void
{
	FlixelFactory._clock.advanceTime(-1);
	super.update(elapsed);
}
</code></pre>
<h3>Render</h3>
<p>Finally, we add the <code>FlxGroup</code> to the <code>FlxState</code> inside the <code>create</code> function so it can be rendered!</p>
<pre><code class="language-haxe">add(armatureGroup);
</code></pre>
<h3>Preview</h3>
<p>That’s it! Once you compile with <code>lime test html5</code>, it should look like this:</p>
<img src="/images/blog/13_dragonbones/dragonbones_preview.gif" width="100%"/><br/><hr/><br/></div></div></div></div></div></main><footer class="footer"><div class="footer-main"><div class=" container"><div class="footer-social"><iframe width="120px" scrolling="0" height="20px" frameBorder="0" src="https://ghbtns.com/github-btn.html?user=HaxeFlixel&amp;repo=flixel&amp;type=watch&amp;count=true&amp;size=small"></iframe><a href="https://twitter.com/haxeflixel" class="twitter-follow-button" data-show-count="true" data-lang="en" data-size="small">Follow @haxeflixel</a><a class="footer-patreon" href="https://www.patreon.com/haxeflixel" title="Support us on Patreon"><img alt="Haxeflixel Patreon" title="Patreon" srcSet="/images/patreon-logo-small.svg 1x, /images/patreon-logo-small.svg 2x" src="/images/patreon-logo-small.svg" width="40" height="40" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a></div><div class="footer-powered-by"><p>HaxeFlixel is powered by</p><a href="http://haxe.org"><img alt="Haxe" title="Haxe" srcSet="/images/haxe.svg 1x, /images/haxe.svg 2x" src="/images/haxe.svg" width="40" height="40" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a>+<a href="http://openfl.org"><img alt="OpenFL" title="OpenFL" srcSet="/images/openfl.svg 1x, /images/openfl.svg 2x" src="/images/openfl.svg" width="40" height="40" decoding="async" data-nimg="1" class="openfl-footer-logo" loading="lazy" style="color:transparent"/></a>+<a href="http://flixel.org"><img alt="Flixel" title="Flixel" srcSet="/images/flixel.svg 1x, /images/flixel.svg 2x" src="/images/flixel.svg" width="40" height="40" decoding="async" data-nimg="1" class="flixel-footer-logo" loading="lazy" style="color:transparent"/></a></div></div></div></footer><script src="/_next/static/chunks/webpack-6588fe9a4e0ab52a.js" async=""></script><script src="/_next/static/chunks/17-2fbad5a8fc7a3fb9.js" async=""></script><script src="/_next/static/chunks/main-app-f7991bdf5a7d528d.js" async=""></script></body></html><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"M1:{\"id\":\"7954\",\"name\":\"\",\"chunks\":[\"272:webpack-6588fe9a4e0ab52a\",\"17:17-2fbad5a8fc7a3fb9\",\"744:main-app-f7991bdf5a7d528d\"],\"async\":false}\nM2:{\"id\":\"4090\",\"name\":\"\",\"chunks\":[\"30:30-b47b7e3ef59158d9\",\"90:90-19e2035b40cf9494\",\"931:app/page-cbee7de8152e1b3e\"],\"async\":false}\nM3:{\"id\":\"30\",\"name\":\"\",\"chunks\":[\"30:30-b47b7e3ef59158d9\",\"976:app/sponsors/page-5aaa65efc5d7a9a6\"],\"async\":false}\nM4:{\"id\":\"9875\",\"name\":\"\",\"chunks\":[\"272:webpack-6588fe9a4e0ab52a\",\"17:17-2fbad5a8fc7a3fb9\",\"744:main-app-f7991bdf5a7d528d"])</script><script>self.__next_f.push([1,"\"],\"async\":false}\nM5:{\"id\":\"2092\",\"name\":\"\",\"chunks\":[\"272:webpack-6588fe9a4e0ab52a\",\"17:17-2fbad5a8fc7a3fb9\",\"744:main-app-f7991bdf5a7d528d\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"J0:[\"$\",\"@1\",null,{\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/13-HaxeFlixel-DragonBones-Support\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"blogPost\",\"13-HaxeFlixel-DragonBones-Support\",\"d\"],{\"children\":[\"\",{}]}]}]},null,null,true],\"initialHead\":null,\"children\":[[[\"$\",\"link\",\"static/media/f884d4ea94220255.p.woff2\",{\"rel\":\"preload\",\"href\":\"/_next/static/media/f884d4ea94220255.p.woff2\",\"as\":\"font\",\"type\":\"font/woff2\",\"crossOrigin\":\"anonymous\"}]],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/97bdc754440853c7.css\",\"precedence\":\"high\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b76f6b40b08cf2ac.css\",\"precedence\":\"high\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/464b40a213f0faa2.css\",\"precedence\":\"high\"}],[\"$\",\"link\",\"3\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b8f6d7805f6cf732.css\",\"precedence\":\"high\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__className_9318ce\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"title\",null,{\"children\":\"HaxeFlixel.com\"}],[\"$\",\"meta\",null,{\"name\":\"description\",\"content\":\"HaxeFlixel is a 2D Game Engine that lets you create cross-platform games easier with free, open source technology!\"}],[\"$\",\"meta\",null,{\"name\":\"keywords\",\"content\":\"gamedev, game development, cross-platform, haxe, flixel\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/images/favicon.ico\"}],[\"$\",\"script\",null,{\"defer\":true,\"src\":\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"}],[\"$\",\"script\",null,{\"defer\":true,\"src\":\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js\"}],[\"$\",\"script\",null,{\"async\":true,\"src\":\"https://platform.twitter.com/widgets.js\",\"charSet\":\"utf-8\"}]]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"navbar navbar-inverse navbar-fixed-top\",\"children\":[\"$\",\"div\",null,{\"className\":\"container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"navbar-header\",\"children\":[[\"$\",\"button\",null,{\"data-target\":\".navbar-collapse\",\"data-toggle\":\"collapse\",\"className\":\"navbar-toggle\",\"type\":\"button\",\"children\":[[\"$\",\"span\",null,{\"className\":\"icon-bar\"}],[\"$\",\"span\",null,{\"className\":\"icon-bar\"}],[\"$\",\"span\",null,{\"className\":\"icon-bar\"}]]}],[\"$\",\"@2\",null,{\"href\":\"/\",\"className\":\"navbar-brand\",\"children\":[\"$\",\"@3\",null,{\"src\":{\"src\":\"/_next/static/media/haxeflixel-header.19d77213.png\",\"height\":30,\"width\":169,\"blurDataURL\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAABCAYAAADjAO9DAAAAJklEQVR4nGPsXzz5rSSvbF24v//e379/87OwsDAyMDD8A2IQ/RkAzmIKJsmSsVcAAAAASUVORK5CYII=\",\"blurWidth\":8,\"blurHeight\":1},\"style\":{\"width\":\"169px\",\"height\":\"30px\"},\"alt\":\"HaxeFlixel\",\"width\":\"100\",\"height\":\"100\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"navbar-collapse collapse\",\"children\":[\"$\",\"ul\",null,{\"className\":\"nav navbar-nav\",\"children\":[[\"$\",\"li\",null,{\"className\":\"dropdown \",\"children\":[[\"$\",\"a\",null,{\"href\":\"#\",\"className\":\"dropdown-toggle\",\"data-toggle\":\"dropdown\",\"role\":\"button\",\"aria-haspopup\":\"true\",\"aria-expanded\":\"false\",\"children\":[\"Examples \",[\"$\",\"span\",null,{\"className\":\"caret\"}]]}],[\"$\",\"ul\",null,{\"className\":\"dropdown-menu inverse-dropdown\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"@2\",null,{\"href\":\"/demos\",\"children\":\"Demos\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://snippets.haxeflixel.com/\",\"children\":\"Snippets\"}]}]]}]]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"@2\",null,{\"href\":\"/showcase\",\"children\":\"Showcase\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"@2\",null,{\"href\":\"/blog\",\"children\":\"Blog\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"@2\",null,{\"href\":\"/documentation\",\"children\":\"Docs\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"http://api.haxeflixel.com\",\"children\":\"API\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/HaxeFlixel/flixel/discussions\",\"children\":\"Forum\"}]}]]}]}]]}]}],[\"$\",\"main\",null,{\"children\":[\"$\",\"@4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"hasLoading\":false,\"template\":[\"$\",\"@5\",null,{}],\"notFound\":[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"-apple-system, BlinkMacSystemFont, Roboto, \\\"Segoe UI\\\", \\\"Fira Sans\\\", Avenir, \\\"Helvetica Neue\\\", \\\"Lucida Grande\\\", sans-serif\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n            body { margin: 0; color: #000; background: #fff; }\\n            .next-error-h1 {\\n              border-right: 1px solid rgba(0, 0, 0, .3);\\n            }\\n\\n            @media (prefers-color-scheme: dark) {\\n              body { color: #fff; background: #000; }\\n              .next-error-h1 {\\n                border-right: 1px solid rgba(255, 255, 255, .3);\\n              }\\n            }\\n          \"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":0,\"marginRight\":\"20px\",\"padding\":\"0 23px 0 0\",\"fontSize\":\"24px\",\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\",\"textAlign\":\"left\",\"lineHeight\":\"49px\",\"height\":\"49px\",\"verticalAlign\":\"middle\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":\"14px\",\"fontWeight\":\"normal\",\"lineHeight\":\"49px\",\"margin\":0,\"padding\":0},\"children\":\"This page could not be found.\"}]}]]}]]}],\"childProp\":{\"current\":[\"$\",\"@4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"hasLoading\":false,\"template\":[\"$\",\"@5\",null,{}],\"childProp\":{\"current\":[\"$\",\"@4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",[\"blogPost\",\"13-HaxeFlixel-DragonBones-Support\",\"d\"],\"children\"],\"hasLoading\":false,\"template\":[\"$\",\"@5\",null,{}],\"childProp\":{\"current\":[[],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3966fc2c7f21f103.css\",\"precedence\":\"high\"}]],\"@6\"],\"segment\":\"\"},\"rootLayoutIncluded\":true}],\"segment\":[\"blogPost\",\"13-HaxeFlixel-DragonBones-Support\",\"d\"]},\"rootLayoutIncluded\":true}],\"segment\":\"blog\"},\"rootLayoutIncluded\":true}]}],[\"$\",\"footer\",null,{\"className\":\"footer\",\"children\":[\"$\",\"div\",null,{\"className\":\"footer-main\",\"children\":[\"$\",\"div\",null,{\"className\":\" container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"footer-social\",\"children\":[[\"$\",\"iframe\",null,{\"width\":\"120px\",\"scrolling\":\"0\",\"height\":\"20px\",\"frameBorder\":\"0\",\"src\":\"https://ghbtns.com/github-btn.html?user=HaxeFlixel\u0026repo=flixel\u0026type=watch\u0026count=true\u0026size=small\"}],[\"$\",\"a\",null,{\"href\":\"https://twitter.com/haxeflixel\",\"className\":\"twitter-follow-button\",\"data-show-count\":\"true\",\"data-lang\":\"en\",\"data-size\":\"small\",\"children\":\"Follow @haxeflixel\"}],[\"$\",\"a\",null,{\"className\":\"footer-patreon\",\"href\":\"https://www.patreon.com/haxeflixel\",\"title\":\"Support us on Patreon\",\"children\":[\"$\",\"@3\",null,{\"src\":\"/images/patreon-logo-small.svg\",\"alt\":\"Haxeflixel Patreon\",\"title\":\"Patreon\",\"width\":\"40\",\"height\":\"40\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"footer-powered-by\",\"children\":[[\"$\",\"p\",null,{\"children\":\"HaxeFlixel is powered by\"}],[\"$\",\"a\",null,{\"href\":\"http://haxe.org\",\"children\":[\"$\",\"@3\",null,{\"src\":\"/images/haxe.svg\",\"alt\":\"Haxe\",\"title\":\"Haxe\",\"width\":\"40\",\"height\":\"40\"}]}],\"+\",[\"$\",\"a\",null,{\"href\":\"http://openfl.org\",\"children\":[\"$\",\"@3\",null,{\"className\":\"openfl-footer-logo\",\"src\":\"/images/openfl.svg\",\"alt\":\"OpenFL\",\"title\":\"OpenFL\",\"width\":\"40\",\"height\":\"40\"}]}],\"+\",[\"$\",\"a\",null,{\"href\":\"http://flixel.org\",\"children\":[\"$\",\"@3\",null,{\"className\":\"flixel-footer-logo\",\"src\":\"/images/flixel.svg\",\"alt\":\"Flixel\",\"title\":\"Flixel\",\"width\":\"40\",\"height\":\"40\"}]}]]}]]}]}]}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"M7:{\"id\":\"3108\",\"name\":\"\",\"chunks\":[\"277:app/blog/[blogPost]/page-d2eac13d9ceb2814\"],\"async\":false}\n"])</script><script>self.__next_f.push([1,"J6:[\"$\",\"@7\",null,{\"frontMatter\":{\"title\":\"HaxeFlixel DragonBones Support\",\"layout\":\"blog-post\",\"postDate\":\"September 1, 2018\"},\"html\":{\"compiledSource\":\"/*@jsxRuntime automatic @jsxImportSource react*/\\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\\nconst {useMDXComponents: _provideComponents} = arguments[0];\\nfunction _createMdxContent(props) {\\n  const _components = Object.assign({\\n    p: \\\"p\\\",\\n    a: \\\"a\\\",\\n    h3: \\\"h3\\\",\\n    pre: \\\"pre\\\",\\n    code: \\\"code\\\"\\n  }, _provideComponents(), props.components);\\n  return _jsxs(_Fragment, {\\n    children: [_jsxs(_components.p, {\\n      children: [\\\"Hi there, I’m Troy (\\\", _jsx(_components.a, {\\n        href: \\\"https://twitter.com/roustudios\\\",\\n        children: \\\"@RouStudios\\\"\\n      }), \\\"), creator and maintainer of the \\\", _jsx(_components.a, {\\n        href: \\\"https://github.com/openfl/dragonbones\\\",\\n        children: \\\"HaxeFlixel backend for DragonBones\\\"\\n      }), \\\". I’m here to write a post about DragonBones support for HaxeFlixel and how to use it.\\\"]\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"First of all, what is DragonBones? DragonBones is a free *open source alternative to the popular 2D bone animation tool \\\", _jsx(_components.a, {\\n        href: \\\"http://esotericsoftware.com/\\\",\\n        children: \\\"Spine\\\"\\n      }), \\\" (which Flixel already has support for). Its a tool which allows you to animate static 2D images programmatically (similar to Flash tweening) without having to painstakingly animate each individual frame in a spritesheet. Why would one use it over Spine? Well Spine can potentially be \\\", _jsx(_components.a, {\\n        href: \\\"https://esotericsoftware.com/spine-purchase\\\",\\n        children: \\\"quite expensive\\\"\\n      }), \\\" for new indie devs, and DragonBones is free. Not only that, DragonBones is a fully featured, intuitive bone animation editor and has \\\", _jsx(_components.a, {\\n        href: \\\"https://www.youtube.com/watch?v=XPH_ZBzCtfY\\\",\\n        children: \\\"Mesh Deformation support\\\"\\n      }), \\\" just like Spine. Quite a deal for free!\\\"]\\n    }), \\\"\\\\n\\\", _jsx(\\\"img\\\", {\\n      src: \\\"/images/blog/13_dragonbones/dragonbones_stock.jpg\\\",\\n      width: \\\"100%\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"*One caveat is that DragonBones is not truly open source (if you care about that sort of thing), only the runtime is. If you want a truly open source editor which can export to the DragonBones format while also being fully featured, check out the great alternative \\\", _jsx(_components.a, {\\n        href: \\\"https://github.com/ndee85/coa_tools\\\",\\n        children: \\\"COA Tools\\\"\\n      }), \\\" for Blender. Its DragonBones export should also work with the Flixel backend I’ve created.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.p, {\\n      children: \\\"How exactly do you use DragonBones with Flixel? Well, that’s what I’ll be showing you, so let’s get started.\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Install\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.p, {\\n      children: \\\"First install the library from haxelib using:\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        children: \\\"haxelib install dragonbones\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.p, {\\n      children: \\\"Although it’s better to install directly from GitHub in order to always keep up with the latest updates:\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        children: \\\"haxelib git dragonbones https://github.com/openfl/dragonbones\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Create Project\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Then create a new Flixel project template with \\\", _jsx(_components.a, {\\n        href: \\\"http://haxeflixel.com/documentation/flixel-tools/\\\",\\n        children: \\\"Flixel Tools\\\"\\n      }), \\\", and add DragonBones to your \\\", _jsx(_components.code, {\\n        children: \\\"Project.xml\\\"\\n      }), \\\". You can also download \\\", _jsx(_components.a, {\\n        href: \\\"https://github.com/openfl/dragonbones/tree/master/samples/HelloDragonBones\\\",\\n        children: \\\"the sample project\\\"\\n      }), \\\" instead to follow along.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-xml\\\",\\n        children: \\\"\u003chaxelib name=\\\\\\\"dragonbones\\\\\\\" /\u003e\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Then create a new animation using DragonBones. For the sake of this tutorial, we’re going to use a premade project that comes with DragonBones called DragonBoy that you can select from the starting menu. Once you’re done, go to \\\", _jsx(_components.code, {\\n        children: \\\"File \u003e Export\\\"\\n      }), \\\" and export the animation using \\\", _jsx(_components.code, {\\n        children: \\\"Data Version: 5.0\\\"\\n      }), \\\" and \\\", _jsx(_components.code, {\\n        children: \\\"Image Type: Texture Atlas\\\"\\n      }), \\\". Then save it to the \\\", _jsx(_components.code, {\\n        children: \\\"assets\\\"\\n      }), \\\" folder in your Flixel project.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(\\\"img\\\", {\\n      src: \\\"/images/blog/13_dragonbones/dragonbones_export.png\\\",\\n      width: \\\"100%\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Packages\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.p, {\\n      children: \\\"First, import the packages we'll be using.\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"import haxe.Json;\\\\nimport openfl.Assets;\\\\nimport flixel.FlxG;\\\\nimport flixel.FlxState;\\\\nimport flixel.group.FlxGroup;\\\\nimport dragonBones.objects.DragonBonesData;\\\\nimport dragonBones.flixel.FlixelTextureAtlasData;\\\\nimport dragonBones.flixel.FlixelArmatureDisplay;\\\\nimport dragonBones.flixel.FlixelArmatureCollider;\\\\nimport dragonBones.flixel.FlixelFactory;\\\\nimport dragonBones.flixel.FlixelEvent;\\\\nimport dragonBones.animation.WorldClock;\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Create Factory\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Then, inside the \\\", _jsx(_components.code, {\\n        children: \\\"create\\\"\\n      }), \\\" function under your \\\", _jsx(_components.code, {\\n        children: \\\"FlxState\\\"\\n      }), \\\" class you have to create a \\\", _jsx(_components.code, {\\n        children: \\\"FlixelFactory\\\"\\n      }), \\\" which generates flixel objects for DragonBones like so:\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"var _factory = new FlixelFactory();\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Parse Data\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.p, {\\n      children: \\\"Then you have to use the factory to parse the animation files that you’ve exported in order to read their data.\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"var dragonBonesData:DragonBonesData = _factory.parseDragonBonesData(\\\\n\\\\tJson.parse(Assets.getText(\\\\\\\"assets/dragonboy_flixel_ske.json\\\\\\\"))\\\\n);\\\\n\\\\n_factory.parseTextureAtlasData(\\\\n\\\\tJson.parse(Assets.getText(\\\\\\\"assets/dragonboy_flixel_tex.json\\\\\\\")),\\\\n\\\\tAssets.getBitmapData(\\\\\\\"assets/dragonboy_flixel_tex.png\\\\\\\")\\\\n);\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Build Armature\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Then you have to create a \\\", _jsx(_components.code, {\\n        children: \\\"FlxGroup\\\"\\n      }), \\\" which will contain all the DragonBones Flixel Sprites. You can do so by declaring a variable and then assigning the new \\\", _jsx(_components.code, {\\n        children: \\\"FlxGroup\\\"\\n      }), \\\" to it which you will generate using the factory.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"var armatureGroup = _factory.buildArmatureDisplay(new FlixelArmatureCollider(250, 250, 27, 25, 13, 8), dragonBonesData.armatureNames[0]);\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"One thing to note is you also have to pass in a collision box similar to the Flixel Spine plugin. This is because with many different sprites, if you want to check the collisions of the entire “character” then you have to have one large collision box. You also pass in the name of the armature (the animations skeleton). Generally you’ll only have one armature, so just pass in the first index of the \\\", _jsx(_components.code, {\\n        children: \\\"armatureNames\\\"\\n      }), \\\" array from the data you got earlier. Otherwise, check your animation in DragonBones to find the name and pass it in as a string.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Set Properties\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Then you iterate through all of the sprites in the \\\", _jsx(_components.code, {\\n        children: \\\"FlxGroup\\\"\\n      }), \\\" to set their initial properties (such as scale, placement in the world, ect.) as you please.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"armatureGroup.forEach(function(display:FlixelArmatureDisplay) {\\\\n\\\\tdisplay.antialiasing = true;\\\\n\\\\tdisplay.x = 100;\\\\n\\\\tdisplay.y = 100;\\\\n\\\\tdisplay.scaleX = 0.50;\\\\n\\\\tdisplay.scaleY = 0.50;\\\\n});\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Start Animation\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.p, {\\n      children: \\\"Now you do the same thing to start the initial animation. Again we grab the first index from the list of animation names to keep it simple.\\\"\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"armatureGroup.forEach(function(display:FlixelArmatureDisplay) {\\\\n\\\\tdisplay.animation.play(display.animation.animationNames[0]);\\\\n});\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Update Animation\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Then, inside the update loop of the \\\", _jsx(_components.code, {\\n        children: \\\"FlxState\\\"\\n      }), \\\" class, add \\\", _jsx(_components.code, {\\n        children: \\\"FlixelFactory._clock.advanceTime(-1);\\\"\\n      }), \\\" to update the animation clock so that the factory knows what point it's at on the timeline.\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"override public function update(elapsed:Float):Void\\\\n{\\\\n\\\\tFlixelFactory._clock.advanceTime(-1);\\\\n\\\\tsuper.update(elapsed);\\\\n}\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Render\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"Finally, we add the \\\", _jsx(_components.code, {\\n        children: \\\"FlxGroup\\\"\\n      }), \\\" to the \\\", _jsx(_components.code, {\\n        children: \\\"FlxState\\\"\\n      }), \\\" inside the \\\", _jsx(_components.code, {\\n        children: \\\"create\\\"\\n      }), \\\" function so it can be rendered!\\\"]\\n    }), \\\"\\\\n\\\", _jsx(_components.pre, {\\n      children: _jsx(_components.code, {\\n        className: \\\"language-haxe\\\",\\n        children: \\\"add(armatureGroup);\\\\n\\\"\\n      })\\n    }), \\\"\\\\n\\\", _jsx(_components.h3, {\\n      children: \\\"Preview\\\"\\n    }), \\\"\\\\n\\\", _jsxs(_components.p, {\\n      children: [\\\"That’s it! Once you compile with \\\", _jsx(_components.code, {\\n        children: \\\"lime test html5\\\"\\n      }), \\\", it should look like this:\\\"]\\n    }), \\\"\\\\n\\\", _jsx(\\\"img\\\", {\\n      src: \\\"/images/blog/13_dragonbones/dragonbones_preview.gif\\\",\\n      width: \\\"100%\\\"\\n    })]\\n  });\\n}\\nfunction MDXContent(props = {}) {\\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\\n    children: _jsx(_createMdxContent, props)\\n  })) : _createMdxContent(props);\\n}\\nreturn {\\n  default: MDXContent\\n};\\n\",\"frontmatter\":{},\"scope\":{}}}]\n"])</script>